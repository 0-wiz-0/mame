// license:BSD-3-Clause
// copyright-holders:Ryan Holtz

/***************************************************************************

  Netlist (stuntcyc) included from atarittl.cpp

***************************************************************************/

#include "netlist/devices/net_lib.h"

NETLIST_START(stuntcyc)

	SOLVER(Solver, 48000)
	PARAM(Solver.PARALLEL, 0) // Don't do parallel solvers
	PARAM(Solver.ACCURACY, 1e-4) // works and is sufficient
	PARAM(NETLIST.USE_DEACTIVATE, 1)

	ANALOG_INPUT(V5, 5)

	TTL_INPUT(high, 1)
	TTL_INPUT(low, 0)

	MAINCLOCK(main_clk, 14318181.8)
	ALIAS(Y1, main_clk)

#if 0
	TTL_7404_INVERT(N3_6, main_clk)
	ALIAS(HF_CLOCK, N3_6.Q)

	ALIAS(P, high)
	ALIAS(GND, low)

	TTL_7474(N4_2, N3_6.Q, N4_2.QQ, P, P)
	ALIAS(CLOCKQ, N4_2.QQ)

	TTL_9316(M4, N4_2.Q,     P, P, P, J6_1.Q, GND, GND, GND, GND)
	TTL_9316(L4, N4_2.Q, M4.RC, P, P, J6_1.Q, GND, GND, GND, GND)
	ALIAS(  1H, M4.QA)
	ALIAS(  2H, M4.QB)
	ALIAS(  4H, M4.QC)
	ALIAS(  8H, M4.QD)
	ALIAS( 16H, L4.QA)
	ALIAS( 32H, L4.QB)
	ALIAS( 64H, L4.QC)
	ALIAS(128H, L4.QD)

	TTL_74107(K4_1, 128H, P, P, P)
	ALIAS(256H,  K4_1.Q)
	ALIAS(256HQ, K4_1.QQ)

	TTL_7420_NAND(J6_1, 8H, 64H, 128H, 256H)
	ALIAS(HRESETQ, J6_1.Q)

	TTL_7404_INVERT(H6_3, HRESETQ)
	ALIAS(HRESET, H6_3.Q)

	TTL_7493(L3, HRESET, L3.QA, VRESET, VRESET)
	TTL_7493(K3, L3.QD,  K3.QA, VRESET, VRESET)
	ALIAS(  1V, L3.QA)
	ALIAS(  2V, L3.QB)
	ALIAS(  4V, L3.QC)
	ALIAS(  8V, L3.QD)
	ALIAS( 16V, K3.QA)
	ALIAS( 32V, K3.QB)
	ALIAS( 64V, K3.QC)
	ALIAS(128V, K3.QD)

	TTL_74107(K4_2, 128V, P, P, VRESETQ)
	ALIAS(256V, K4_2.Q)
	ALIAS(256VQ, K4_2.QQ)

	TTL_7410_NAND(M5_3, 256V, 2V, 1V)
	TTL_7474(M3_2, HRESET, M5_3.Q, P, P)
	ALIAS(VRESET, M3_2.QQ)
	ALIAS(VRESETQ, M3_2.Q)

	TTL_7402_NOR(J5_2, H6_3.Q, J5_1.Q)
	TTL_7402_NOR(J5_1, 32H,    J5_2.Q)
	TTL_7402_NOR(J5_3,  8V,    J5_4.Q)
	TTL_7402_NOR(J5_4, VRESET, J5_3.Q)
	ALIAS(HSYNC,  J5_1.Q)
	ALIAS(HSYNCQ, J5_2.Q)
	ALIAS(VSYNC,  J5_3.Q)
	ALIAS(VSYNCQ, J5_4.Q)

	TTL_7486_XOR(J4_1, HSYNC, VSYNCQ)
	ALIAS(COMPSYNCQ, J4_1.Q)

	TTL_7474(N4_1, HWINDOW, HSYNC, RAMP_WINDOW_HITQ, N4_1.QQ)
	TTL_7474(M3_1, N4_1.Q, M3_1.QQ, CYCLE_RESETQ, P)
	ALIAS(DIRECTION, M3_1.Q)
	ALIAS(DIRECTIONQ, M3_1.QQ)

	TTL_7404_INVERT(N3_3, 32V)
	TTL_7474(J2_2, N3_3.Q, J2_1.Q, P, P)
	TTL_7474(J2_1, N4_1.Q, P, J2_2.QQ, P)

	TTL_7408_AND(H5_2, 256VQ, VSYNCQ)
	TTL_9316(K1, HSYNC,     P, H5_2.Q,  V_COUNTER_RESETQ, L2_3.Q,  Av,  Bv,  Cv,  Dv)
	TTL_9316(K2, HSYNC, K1.RC, J2_2.QQ, V_COUNTER_RESETQ, L2_3.Q, GND, GND, GND, GND)
	TTL_7400_NAND(L2_3, K1.RC, K2.RC)

	TTL_7402_NOR(D4_3, DIRECTION, H6)
	TTL_7408_AND(B5_1, DIRECTION, H5H6)
	TTL_7402_NOR(D4_4, D4_3.Q, B5_1.Q)
	TTL_7400_NAND(H2_1, HSYNCQ, D4_4.Q)
	TTL_7400_NAND(H2_2, HSYNCQ, H5)

	TTL_9322(J1, HSYNC, V4, P, V3, 4V, V1, 1V, V2, 2V, GND)
#endif
NETLIST_END()
